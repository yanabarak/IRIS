{"ast":null,"code":"import { client } from \"./Request\";\nimport SecureLS from \"secure-ls\";\nimport serverConfig from '../../server.config.json';\nimport moment from \"moment-timezone\";\nexport const DEFAULT_STORAGE = new SecureLS({\n  encodingType: 'base64',\n  isCompression: false\n});\nexport const STORAGE_PREFIX = serverConfig.storagePrefix;\nexport function setStorage(key, value) {\n  DEFAULT_STORAGE.set(`${STORAGE_PREFIX}.${key}`, value);\n}\nexport function getStorage(key) {\n  try {\n    return DEFAULT_STORAGE.get(`${STORAGE_PREFIX}.${key}`) || null;\n  } catch (error) {\n    return null;\n  }\n}\nexport function removeStorage(key) {\n  return DEFAULT_STORAGE.remove(`${STORAGE_PREFIX}.${key}`);\n}\nexport function hasAuthUser() {\n  let user = getStorage(\"auth\");\n  user = user && user !== '' ? JSON.parse(user) : {};\n  if (!user) {\n    return false;\n  }\n  return !!user.token;\n}\nexport function getAuthUser() {\n  let user = getStorage(`auth`);\n  user = user && user !== '' ? JSON.parse(user) : {};\n  if (Object.keys(user).length <= 0) {\n    removeStorage(`auth`);\n    return {};\n  }\n  return user;\n}\nexport function dateFormat(date = null, format) {\n  if (date) {\n    return moment(date).format(format);\n  }\n  return date;\n}\nexport function refresh() {\n  window.location.reload(true);\n}\nexport function refreshToHome() {\n  window.location.reload(true);\n}\nexport function handleSyncRequestLoader({\n  dispatch\n}, baseURL) {\n  client.interceptors.request.use(config => {\n    config.baseURL = `${baseURL}`;\n    if (config.method !== \"get\" && config.data && config.data.ignore_request > 0) {\n      return config;\n    } else if (config.method === \"get\" && config.params && config.params.ignore_request > 0) {\n      return config;\n    }\n    dispatch('loader', true);\n    return config;\n  }, error => {\n    return Promise.reject(error);\n  });\n  client.interceptors.response.use(({\n    data\n  }) => {\n    dispatch('loader', false);\n    return Promise.resolve(data);\n  }, error => {\n    dispatch('loader', false);\n    if (error.response && error.response.status === 401) {\n      dispatch('setUnAuthorized', true);\n      setTimeout(() => {\n        dispatch('setUnAuthorized', false);\n      }, 2000);\n    }\n    return Promise.reject(error);\n  });\n}","map":{"version":3,"names":["client","SecureLS","serverConfig","moment","DEFAULT_STORAGE","encodingType","isCompression","STORAGE_PREFIX","storagePrefix","setStorage","key","value","set","getStorage","get","error","removeStorage","remove","hasAuthUser","user","JSON","parse","token","getAuthUser","Object","keys","length","dateFormat","date","format","refresh","window","location","reload","refreshToHome","handleSyncRequestLoader","dispatch","baseURL","interceptors","request","use","config","method","data","ignore_request","params","Promise","reject","response","resolve","status","setTimeout"],"sources":["/home/old/Documents/IRIS_MAN/src/Util/auth.js"],"sourcesContent":["import { client } from \"./Request\";\nimport SecureLS from \"secure-ls\";\nimport serverConfig from '../../server.config.json';\nimport moment from \"moment-timezone\";\n\nexport const DEFAULT_STORAGE = new SecureLS({\n    encodingType: 'base64',\n    isCompression: false\n});\n\nexport const STORAGE_PREFIX = serverConfig.storagePrefix;\n\nexport function setStorage(key, value) {\n    DEFAULT_STORAGE.set(`${ STORAGE_PREFIX }.${ key }`, value);\n}\n\nexport function getStorage(key) {\n    try {\n        return DEFAULT_STORAGE.get(`${ STORAGE_PREFIX }.${ key }`) || null;\n    } catch (error) {\n        return null;\n    }\n}\n\nexport function removeStorage(key) {\n    return DEFAULT_STORAGE.remove(`${ STORAGE_PREFIX }.${ key }`);\n}\n\nexport function hasAuthUser() {\n    let user = getStorage(\"auth\");\n    user = ( ( user && user !== '' ) ? JSON.parse(user) : {} );\n    if ( !user ) {\n        return false;\n    }\n    return !!( user.token );\n}\n\nexport function getAuthUser() {\n    let user = getStorage(`auth`);\n\n    user = ( ( user && user !== '' ) ? JSON.parse(user) : {} );\n\n    if ( Object.keys(user).length <= 0 ) {\n        removeStorage(`auth`);\n        return {};\n    }\n\n    return user;\n}\n\nexport function dateFormat(date = null, format) {\n    if ( date ) {\n        return moment(date).format(format);\n    }\n\n    return date;\n}\n\nexport function refresh() {\n    window.location.reload(true);\n}\n\nexport function refreshToHome() {\n    window.location.reload(true);\n}\n\nexport function handleSyncRequestLoader({ dispatch }, baseURL) {\n    client.interceptors.request.use(\n      config => {\n          config.baseURL = `${ baseURL }`;\n          if ( config.method !== \"get\" && ( config.data && config.data.ignore_request > 0 ) ) {\n              return config;\n          } else if ( config.method === \"get\" && ( config.params && config.params.ignore_request > 0 ) ) {\n              return config;\n          }\n\n          dispatch('loader', true);\n          return config;\n      },\n      error => {\n          return Promise.reject(error);\n      }\n    );\n\n    client.interceptors.response.use(\n      ({ data }) => {\n          dispatch('loader', false);\n          return Promise.resolve(data);\n      },\n      error => {\n          dispatch('loader', false);\n          if ( error.response && error.response.status === 401 ) {\n              dispatch('setUnAuthorized', true);\n              setTimeout(() => {\n                  dispatch('setUnAuthorized', false);\n              }, 2000);\n          }\n          return Promise.reject(error);\n      }\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}